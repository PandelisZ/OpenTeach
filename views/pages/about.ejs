<!-- views/pages/about.ejs -->

<!DOCTYPE html>
<html lang="en">
<head>
    <% include ../partials/head %>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="http://maps.googleapis.com/maps/api/js"></script>
    <script>
var markers = [];
function initialize() {
  var mapProp = {
    center:new google.maps.LatLng(52.48624,	-1.89040),
    zoom:10,
    mapTypeId:google.maps.MapTypeId.ROADMAP
  };
  var map=new google.maps.Map(document.getElementById("googleMap"), mapProp);

  /*var marker=new google.maps.Marker({
    position:myCenter,
    });

  marker.setMap(map);*/

  map.addListener('dragend', function() {

    var ne = map.getBounds().getNorthEast();
    var sw = map.getBounds().getSouthWest();
    var latmin = sw.lat();
    var latmax = ne.lat();
    var lngmin = sw.lng();
    var lngmax = ne.lng();

    /*markers.forEach(function(marker) {
      marker.setMap(null);
    });*/

    $.post('/points', {
      latmin: latmin,
      latmax: latmax,
      lngmin: lngmin,
      lngmax: lngmax
    }, function(data) {
      data.forEach(function(point) {
        var marker = new google.maps.Marker({
          position: { lat: Number(point.lat), lng: Number(point.lng) },
          map: map,
          title: (point.firstname + ' ' + point.lastname)
        });
        var infowindow = new google.maps.InfoWindow({
          content: '<h1>' + point.firstname + ' ' + point.lastname + '</h1>'
        });
        marker.addListener('click', function() {
          infowindow.open(map, marker);
        });
        markers.push(marker);
      });
    });
  });
}

google.maps.event.addDomListener(window, 'load', initialize);

</script>
</head>
<body class="container">

    <header>
        <% include ../partials/header %>
    </header>

    <main>
        <div class="row">
            <div class="col-sm-8">
                <h2>Talent Locator</h2>
                <div class="jumbotron">

                    <div class="input-group">
                          <input type="text" class="form-control" placeholder="Search for...">
                          <span class="input-group-btn">
                            <button class="btn btn-default" type="button">Go!</button>
                          </span>
                        </div><!-- /input-group -->
                    <div id="googleMap" style="width:100%;height:380px;"></div>


                </div>

            </div>
            <div class="col-sm-4">

                <div class="well">
                    <h3>Search for skill</h3>
                    <p>Choose an area and we will show you everyone who is willing to donate their time to your cause</p>
                    <h3>Sign Up for yourself</h3>
                    <p>Do you have spare time and want to help better your community? Why not sign up and help out with community events or in schools and colleges with different workshops and talks.</p>
                </div>

            </div>
        </div>
    </main>
    <footer>
        <% include ../partials/footer %>
    </footer>
</body>
</html>
